****************
Dynamic Analysis
****************

Overview
--------

**Objectives**

The objective of this lab is to complement static binary analysis with
dynamic analysis to understand target program behavior.

**Tools**

WinDbg (or similar user-mode debugger)

IDA Pro

DynamicAnalysis.exe â€“ the target program

**Instructions**

.. admonition:: Note To Instructor. 

   This lab will vary based on how you setup the program. This is just an example of how you could use this program for the lab.

1. Using IDA Pro (or other PE parsing program), determine the virtual
   address for main. What is it?

2. What strings do you see statically in this program?

   a. Do they provide any insight into program behavior (such as domains
      used)?

3. Describe what is happening in function ``sub_4010c0``.

   a. What domains are used?

   b. How are the domains obfuscated?

4. Describe what is happening in function ``sub_401220``.

   a. What is stored in [ebp+var_1c]?

   b. How does this function work?

5. Describe what is happening in function ``sub_2012F0``.

   a. What is significant about the call to *CreateProcessA?*

   b. What does *GetThreadContext* and *SetThreadContext* allow the
      programmer to do.

      i. How is this code using *SetThreadContext?*

   c. How does the program call *ZwUnmapViewofSection?*

      i. What is the purpose of this function

   d. What does this program write into the new processes memory space?
      Describe how it does this.

   e. What happens when *ResumeThread* is called?
