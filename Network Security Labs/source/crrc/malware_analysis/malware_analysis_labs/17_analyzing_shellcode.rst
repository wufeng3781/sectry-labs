*******************
Analyzing Shellcode
*******************

Overview
--------

**Lab Description:** The goal of this lab is to analyze shellcode to
determine its functionality.

This shellcode begins at an offset of +0xE86. Once you load the binary
file in Binary Ninja (BN) the view will be as a hex editor. Right-click
on this offset and select ‘Create Function at this Address’ -> ‘x86’ ->
‘x86’. Begin analysis at this location.

**Lab Environment:** This lab requires the following tools:

-  Disassembly tool such as IDA Pro demo/free or Binary Ninja Demo

-  A debugger

**Lab Files that are needed:** :download:`shellcode.bin<media/17_analyzing_shellcode/shellcode.bin>`

Determine the following by analyzing the sample shellcode:
----------------------------------------------------------

What function is responsible for resolving function addresses? How did
you determine the function?

What is being done starting at offset +0xE8F through +0xE9B? What is in
EAX when those instructions are done?

Identify where the process hollowing is performed (hint, it’s towards
the end of function sub_e86). Describe how this technique works, be
specific. Include screenshots, descriptions and all API calls involved.

What to submit 
--------------

Submit a Microsoft Word document or PDF.
